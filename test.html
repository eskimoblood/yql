<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">                
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

	<title>untitled</title>
	<script type="text/javascript" src="http://www.google.com/jsapi"></script>
	<script type="text/javascript">
	      google.load('visualization', '1', {'packages':['annotatedtimeline']});
	      google.setOnLoadCallback(loadJSONP);
	      
	function loadJSONP() {
	      	var jsonp = document.createElement('script');
			jsonp.type = 'text/javascript'; 
			jsonp.async = true;
			jsonp.src = 'http://query.yahooapis.com/v1/public/yql?q=use%20%20%22http%3A%2F%2Fgithub.com%2Feskimoblood%2Fyql%2Fraw%2Fmaster%2Fsonntagsfrage.xml%22%3B%20select%20*%20from%20sonntagsfrage%20where%20bundesland%3D%22berlin%22&format=json&callback=drawGraph';
			var s = document.getElementsByTagName('script')[0];
			s.parentNode.insertBefore(jsonp, s);
	}
	function drawGraph (json) {
		console.log(json)
		var data = new google.visualization.DataTable(),
			parties = ['SPD', 'CDU', 'GRÃœNE', 'FDP', 'LINKE'],
			result = json.query.results.result.result,
			length = result.length;
		data.addColumn('date', 'Datum');
		for(var i=0; i<5; i++) {
			data.addColumn('number', parties[i]);	
		}
		var rows = [];
		for(i=length-1; i > -1; i--) {
			if(result[i].date != 'Invalid Date') {
				var resultParties = result[i].parties;
				var row = [new Date(result[i].date)];
				for(var j=0; j<5; j++) {
					var value =  parseInt(resultParties[parties[j]]);
				 	row.push(value);
				}
				rows.push(row)
			}
		}
		data.addRows(rows);
		console.log(data)
		var chart = new google.visualization.AnnotatedTimeLine(document.getElementById('chart_div'));
		        chart.draw(data, {displayAnnotations: true,displayAnnotationsFilter:true, colors: ['#EC241F', '#373737', '#7EA858', '#92C4F1', 'A8588B']});
	}
	   </script>
	

	
</head>

<body>
<div id='chart_div' style='width: 1000px; height: 500px;'></div>

</body>
</html>
