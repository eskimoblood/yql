<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">                
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

	<title>untitled</title>
	<script type="text/javascript" src="http://www.google.com/jsapi"></script>
	    <script type="text/javascript">
	      google.load("visualization", "1", {packages:["corechart"]});
	      google.setOnLoadCallback(loadJSONP);
	      
	function loadJSONP() {
	      	var jsonp = document.createElement('script');
			jsonp.type = 'text/javascript'; 
			jsonp.async = true;
			jsonp.src = 'http://query.yahooapis.com/v1/public/yql?q=use%20%20%22http%3A%2F%2Fgithub.com%2Feskimoblood%2Fyql%2Fraw%2Fmaster%2Fsonntagsfrage.xml%22%3B%20select%20*%20from%20sonntagsfrage%20where%20bundesland%3D%22berlin%22&format=json&callback=drawGraph';
			var s = document.getElementsByTagName('script')[0];
			s.parentNode.insertBefore(jsonp, s);
	}
	function drawGraph (json) {
		console.log(json)
		var data = new google.visualization.DataTable(),
			parties = ['SPD', 'CDU', 'GRÃœNE', 'FDP', 'LINKE'],
			result = json.query.results.result.result,
			length = result.length;
		data.addColumn('string', 'Datum');
		for(var i=0; i<5; i++) {
			data.addColumn('number', parties[i]);	
		}
		data.addRows(length);
		for(i=length-1; i > -1; i--) {
			if(result[i].date != 'Invalid Date') {
			data.setValue(i, 0, result[i].date);
			var resultParties = result[i].parties
			for(var j=0; j<5; j++) {
				var value =  parseInt(resultParties[parties[j]]);

				if(value) 	data.setValue(i, j+1, value);
			
			}
			}
		}
		console.log(data)
		var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
		        chart.draw(data, {width: 1000, height: 240, title: 'Company Performance', reverseAxis:true, pointSize: 1, lineSize:1});    
	}
	   </script>
	

	
</head>

<body>
<div id="chart_div"></div>

</body>
</html>
